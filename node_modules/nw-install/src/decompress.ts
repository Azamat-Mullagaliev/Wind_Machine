import path from "node:path";

import extract from "extract-zip";
import tar from "tar";

const decompress = (
  platform: "linux" | "osx" | "win",
  outDir: string,
  outFile: string,
): Promise<number> => {
  return new Promise((resolve: any) => {
    if (platform === "linux") {
      tar
        .x({
          file: `${outDir}/${outFile}.tar.gz`,
          C: `${outDir}`,
        })
        .then(() => {
          resolve(0);
        });
    } else {
      extract(path.resolve(`${outDir}/${outFile}.zip`), {
        dir: path.resolve(`${outDir}`),
      }).then(() => {
        resolve(0);
      });
    }
  });
};

export { decompress };
